{% extends 'fibeWWWConfBundle::base.html.twig' %}

{% block body %}
{{ parent() }}

<div class="container">
    <div class="row center">
    <h1>Event edit</h1>
    <div class="row">
     <div class="col-lg-9"></div>
          <div class="col-lg-2 btn-group">
              <a type="button" href="{{ path('schedule_event') }}" class="btn btn-warning">
                    <i class="icon-th-list"></i>
              </a>
               <form action="{{ path('schedule_confevent_delete', { 'id': entity.id }) }}" method="post">
                  <input type="hidden" name="_method" value="DELETE" />
                    {{ form_widget(delete_form) }}
                <button type="submit" class="btn btn-danger">
                    <i class="icon-remove"></i>
                </button>
              </form> 
          </div>    
    </div>     

    <form action="{{ path('schedule_confevent_update', { 'id': entity.id }) }}" method="post" {{ form_enctype(edit_form) }}>
       <input type="hidden" name="_method" value="PUT" />
       <div class="row">
           <div class="col-lg-2"></div>
           <div class="col-lg-4">
                  {{ form_row(edit_form.summary) }}
                  {{ form_row(edit_form.categories) }}
                  {{ form_row(edit_form.startAt) }}
                  {{ form_row(edit_form.endAt) }}
                  {{ form_row(edit_form.description) }} 
                  {{ form_row(edit_form.url) }} 
            </div>
            <div class="col-lg-4">
                  {{ form_row(edit_form.comment) }}
                  {{ form_row(edit_form.organizer) }}
                  {{ form_row(edit_form.contacts) }}
                  {{ form_row(edit_form.location) }}
                  {{ form_row(edit_form.parent) }}    

                  {{ form_errors(edit_form) }}
                  </br>
              </div>
              <div style="visibility:hidden;display:none;height:0px;" id="hiddenInputs">     
                  {{ form_rest(edit_form)}}
              </div>                       
        </div> 
        </br>
         <div class="row"> 
            <div class="col-lg-4"></div>
            <div class="col-lg-4">  
                 <button type="submit" class="btn btn-block btn-success">
                          <i class="icon-ok"></i>
                </button>
            </div>
        </div>
    </form>
      
        </br></br>

         
            <div class="row">
               <div class="col-lg-2"></div>
               <div class="col-lg-8">
                <h1>Themes</h1>
                 <a  class="btn btn-link btn-small help"  data-toggle="popover" title="Add theme to the event" data-content="For add a theme to the event, select it in the  select field.">
                       <i class="icon-question"></i>
                  </a>    
                 
                <div id="themes_related_list">
                  {% include "fibeWWWConfBundle:ConfEvent:themeRelation.html.twig" %}
                </div>
                 {{ form_widget(theme_form) }}    
              </div>  
            </div> 
         
        </br></br>
           
            <div class="row">
               <div class="col-lg-2"></div>
               <div class="col-lg-8">
                <h1>Papers Relation</h1>
                 <a  class="btn btn-link btn-small help" data-toggle="popover" title="Add paper to the event" data-content="For add a paper to the event, select it in the select field.">
                       <i class="icon-question"></i>
                    </a>
                
                 <div id="paper_related_list">
                    {% include "fibeWWWConfBundle:ConfEvent:paperRelation.html.twig" %}
                </div>
                {{ form_widget(paper_form) }}
              </div>
            </div>

        </br></br>

            <div class="row">
               <div class="col-lg-2"></div>
               <div class="col-lg-8">
                  <h1>Persons Relation</h1>
                  <a  class="btn btn-link btn-small help" data-toggle="popover" title="Add a person to the event" data-content='For add a person to the event, select it in the select field and the role of this person for the event. Then, click on "add person".'>
                       <i class="icon-question"></i>
                  </a>
                <div id="person_related_list"> 
                    {% include "fibeWWWConfBundle:ConfEvent:personRelation.html.twig" %}
                </div>

            <form id="role_form" action="{{ path('schedule_confevent_addPerson')}}" method="post" {{ form_enctype(role_form) }}>
                 {{ form_widget(role_form) }}
                 {{ form_errors(role_form) }}
                 </br>
                  <button id="role_form_submit"class="btn btn-info" type="button" onclick="addPerson()">
                    <i class="icon-plus"></i> add Person
                </button>
                 </form>
                 </br>
               
          </div>
        </div>
      </br>

  </div>
</div>
{% endblock %}

{% block javascripts %}
{{ parent() }}
<script type="text/javascript">

   $(document).ready(function() {
   //listen for the form beeing submitted
   $("#form_papers").change(function(){
      //get the url for the form
      var id_paper= $(this).val();
  
      //start send the post request
       $.post('{{path("schedule_confevent_addPaper") }}',               
                {id_entity : '{{entity.id}}', id_paper: id_paper}, 
            function(response){
                   $('#paper_related_list').html(response);
                
            }, "html");    
       });

    //listen for the form beeing submitted
   $("#form_themes").change(function(){
      //get the url for the form
      var id_theme= $(this).val();
  
      //start send the post request
       $.post('{{path("schedule_confevent_addTheme") }}',               
                {id_entity : '{{entity.id}}', id_theme: id_theme}, 
            function(response){
                   $('#themes_related_list').html(response);
                
            }, "html");    
       });

     function addPerson(){
        //get the url for the form
        var id_person = $('#fibe_bundle_wwwconfbundle_roletype_person').val();
        var id_type = $('#fibe_bundle_wwwconfbundle_roletype_type').val();

        //start send the post request
         $.post("{{path('schedule_confevent_addPerson')}}",               
                 {id_person : id_person, id_type:id_type, id: "{{entity.id }}"} , 
              function(response){
                     $('#person_related_list').html(response);
                  
              }, "html");    
          return false;
         };
       

     $('.help').popover({ 'trigger': 'click', 'placement':'bottom'});
   
  
});
</script>

{% endblock javascripts %}
