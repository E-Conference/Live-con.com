

{% block body %}


    <form id="eventForm" action="#" method="post" {{ form_enctype(edit_form) }}>
        <input type="hidden" name="_method" value="PUT" />
        {{ form_row(edit_form.summary) }}
        {{ form_row(edit_form.categories) }}
        {{ form_row(edit_form.startAt) }}
        {{ form_row(edit_form.url) }}
        {{ form_row(edit_form.parent) }}
        {{ form_row(edit_form.description) }}
        {{ form_row(edit_form.comment) }}
        {{ form_row(edit_form.organizer) }}
        {{ form_row(edit_form.contacts) }}
        {{ form_row(edit_form.location) }}
        {{ form_row(edit_form.priority) }}
        {{ form_row(edit_form.resources) }}
        {{ form_row(edit_form.endAt) }}
        {{ form_row(edit_form.isTransparent) }}
        {{ form_row(edit_form.wwwConf) }}

        <button class="btn btn-primary" type="submit"><i class="icon-ok"></i> Save</button>

            <div style="visibility:hidden;display:none;height:0px;" id="hiddenInputs">     
                {{ form_rest(edit_form  )}}
            </div> 
    </form>

    <form id="delete-event-form">
        <input type="hidden" name="_method" value="DELETE" />
          {{ form_widget(delete_form) }}
      <button type="submit" class="btn btn-danger">
          <i class="icon-trash"></i>
      </button>
    </form>
         <p>
            <h1>Themes</h1>
            <div id="themes_related_list">
                {% include "fibeWWWConfBundle:ConfEvent:themeRelation.html.twig" %}
            </div>
                 {{ form_widget(theme_form) }}        
        </p>
  
        <p>

            <h1>Papers Relation</h1>
            <div id="paper_related_list">

                {% include "fibeWWWConfBundle:ConfEvent:paperRelation.html.twig" %}
            </div>
                {{ form_widget(paper_form) }}


              <h1>Persons Relation</h1>
               <div id="person_related_list">
                {% include "fibeWWWConfBundle:ConfEvent:personRelation.html.twig" %}
             </div>
            <form id="role_form" action="{{ path('schedule_confevent_addPerson')}}" method="post" {{ form_enctype(role_form) }}>
                 {{ form_widget(role_form) }}
                 </br>
                <button type="submit" class="btn btn-info" type="button">
                    <i class="icon-plus"></i> add Role
                </button>
            </form>
        </p>

  

    
{% block javascripts %} 
      <script type="text/javascript" >
        $(document).ready(function() { $("select").select2(); });
      </script> 
<script type="text/javascript">
    var ajaxForms = [
        {
            formId : "#eventForm",
            route : '{{path("schedule_confevent_update", { "id": entity.id }) }}',
            callback : function(response){
              bootstrapAlert("success","Event updated");
            }
        },
        {
            formId : "#delete-event-form",
            route : "{{ path('schedule_confevent_delete', { 'id': entity.id }) }}",
            callback : function(response){
              bootstrapAlert("success","Event deleted");
            },
        },
    ];

    $(document).ready(function() { 
      for (var i in ajaxForms){
        var form = ajaxForms[i];   
        $(form.formId).off("submit").submit({form:form},function(e){ 
          form = e.data.form;
          $.post(form.route,               
            $(form.formId).serialize(),
            function(r){form.callback(r);}
          );    
          return false;
        });
      } 

     //listen for the form beeing submitted
     $("select[id='form_papers']").change(function(){
        //get the url for the form
        var id_paper= $(this).val();
    
        //start send the post request
         $.post('{{path("schedule_confevent_addPaper") }}',               
                  {id_entity : '{{entity.id}}', id_paper: id_paper},
              function(response){
                     $('#paper_related_list').html(response);
                  
              }, "html");    
         });

      //listen for the form beeing submitted
     $("select[id='form_themes']").change(function(){
        //get the url for the form
        var id_theme= $(this).val();
    
        //start send the post request
         $.post('{{path("schedule_confevent_addTheme") }}',               
                  {id_entity : '{{entity.id}}', id_theme: id_theme}, 
              function(response){
                     $('#themes_related_list').html(response);
                  
              }, "html");    
         });

       $("#role_form").submit(function(){
        //get the url for the form
        var id_person = $('#fibe_bundle_wwwconfbundle_roletype_person').val();
        var id_type = $('#fibe_bundle_wwwconfbundle_roletype_type').val();
        //start send the post request
         $.post("{{path('schedule_confevent_addPerson')}}",               
                 {id_person : id_person, id_type:id_type, id: "{{entity.id }}"} , 
              function(response){
                     $('#person_related_list').html(response);
                  
              }, "html");    
          return false;
         });
        })
</script>
{% endblock javascripts %}

{% endblock %}
